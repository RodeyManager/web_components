<!--build header-->
<!DOCTYPE html>
<html class="" style="">
<head lang="en">
    <title>拖动滑块组件</title>
    <meta charset="UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge">
    <meta content="descriptions" charset="">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-status-bar-style" content="black-translucent">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
    <meta name="format-detection" content="telephone=no" />
    <link href="assets/css/app.min.css?_cmbx_=8df2534682" rel="stylesheet" media="screen">
    <script src="assets/js/libs.js?_cmbx_=416ee13b71"></script>
</head>
<body class="" style="">
    <style>
        .v-bar-box{ position: fixed; top: 0; right: 100px; }
    </style>
    <style type="text/css" charset="utf-8">.seek-bar-box.hbar{
    position: relative;
    width: 600px;
    height: 30px;
    padding: 0;
    margin: 50px auto;
    vertical-align: middle;
    -webkit-user-select: none;
    -moz-user-select: none;
    user-select: none;
}
.seek-bar-box.hbar > ul{
    width: 100%;
    height: 100%;
    padding: 0;
    margin: 0 auto;
    position: relative;
    list-style: none;
    font-size: 0;
    background-color: #DEDEDE;
    box-shadow: inset 0 0 1px 1px #D4D4D4;
}
.seek-bar-box.hbar > ul > li{
    display: inline-block;
    width: 50px;
    height: 100%;
    line-height: 30px;
    text-align: center;
    color: white;
    border-right: solid 1px #BFBFBF;
    margin: 0 auto;
    font-size: 14px;
    position: relative;
    box-sizing: border-box;
    cursor: default;
    -webkit-transition: all 0.15s ease;
    -moz-transition: all 0.15s ease;
    -ms-transition: all 0.15s ease;
    transition: all 0.15s ease;
}
.seek-bar-box.hbar > ul > li.on-include{
    background-color: #4ab5ff;
    border-right: solid 1px #2196F3;
    box-shadow: inset 0 0 1px 1px #65CFFF;
}
.seek-bar-box.hbar > ul > li:last-child{
    border-right: none;
}
.seek-bar-box.hbar > .slider-btn{
    display: block;
    width: 20px;
    height: 40px;
    position: absolute;
    top: -5px;
    left: 0;
    background-color: #029BE0;
    box-shadow: 1px 0 1px 0 rgba(65, 187, 243, 0.25);
    text-align: center;
    cursor: move;
    -webkit-transition: all 0.15s ease;
    -moz-transition: all 0.15s ease;
    -ms-transition: all 0.15s ease;
    transition: all 0.15s ease;
}
.seek-bar-box.hbar > .slider-btn > i{
    display: inline-block;
    width: 3px;
    height: 20px;
    margin: 10px auto;
    border-radius: 1px;
    background-color: rgba(226, 226, 226, 0.73);
    box-shadow: 0 0 1px 1px #D4D4D4 inset;
}
.seek-bar-box.hbar > .slider-btn:hover{
    background-color: #00AAF7;
}

.seek-bar-box.hbar > ul > li.on-current{
    text-align: left;
    text-indent: 10px;
}
.seek-bar-box.hbar > ul > li.on-current:after{
    content: "个月";
    font-size: 10px;
    color: white;
    position: absolute;
    top: -5px;
    right: 0;
    -webkit-transform: scale(0.8);
    -moz-transform: scale(0.8);
    -ms-transform: scale(0.8);
    -o-transform: scale(0.8);
    transform: scale(0.8);
}</style>
<div class="seek-bar-box hbar" id="seek-hbar">
    <ul>
        <li>1</li>
        <li>2</li>
        <li>3</li>
        <li>4</li>
        <li>5</li>
        <li>6</li>
        <li>7</li>
        <li>8</li>
        <li>9</li>
        <li>10</li>
        <li>11</li>
        <li>12</li>
    </ul>
    <span class="slider-btn">
        <i></i>
        <i></i>
    </span>
</div>
    <div class="v-bar-box">
        <style type="text/css" charset="utf-8">.seek-bar-box.vbar{
    position: relative;
    width: 30px;
    height: 300px;
    padding: 0;
    margin: 50px auto;
    vertical-align: middle;
    -webkit-user-select: none;
    -moz-user-select: none;
    user-select: none;
}
.seek-bar-box.vbar > ul{
    width: 100%;
    height: 100%;
    padding: 0;
    margin: 0 auto;
    position: relative;
    list-style: none;
    font-size: 0;
    background-color: #DEDEDE;
    box-shadow: inset 0 0 1px 1px #D4D4D4;
}
.seek-bar-box.vbar > ul > li{
    display: inline-block;
    width: 100%;
    height: 30px;
    line-height: 30px;
    text-align: center;
    color: white;
    border-bottom: solid 1px #BFBFBF;
    margin: 0 auto;
    font-size: 14px;
    position: relative;
    box-sizing: border-box;
    cursor: default;
    -webkit-transition: all 0.15s ease;
    -moz-transition: all 0.15s ease;
    -ms-transition: all 0.15s ease;
    transition: all 0.15s ease;
}
.seek-bar-box.vbar > ul > li.on-include{
    background-color: #4ab5ff;
    border-bottom: solid 1px #2196F3;
    box-shadow: inset 0 0 1px 1px #65CFFF;
}
.seek-bar-box.vbar > ul > li:last-child{
    border-bottom: none;
}
.seek-bar-box.vbar > .slider-btn{
    display: block;
    width: 40px;
    height: 10px;
    position: absolute;
    top: 0;
    left: -5px;
    background-color: #029BE0;
    box-shadow: 1px 0 1px 0 rgba(65, 187, 243, 0.25);
    text-align: center;
    cursor: move;
    -webkit-transition: all 0.15s ease;
    -moz-transition: all 0.15s ease;
    -ms-transition: all 0.15s ease;
    transition: all 0.15s ease;
}
.seek-bar-box.vbar > .slider-btn > i{
    display: block;
    width: 20px;
    height: 1px;
    margin: 2.5px auto;
    border-radius: 1px;
    background-color: rgba(226, 226, 226, 0.73);
    box-shadow: 0 0 1px 1px #D4D4D4 inset;
}
.seek-bar-box.vbar > .slider-btn:hover{
    background-color: #00AAF7;
}

.seek-bar-box.vbar > ul > li.on-current{
    text-shadow: 1px 1px 1px #505050;
}
.seek-bar-box.vbar > ul > li.on-current:before,
.seek-bar-box.vbar > ul > li.on-current:after{
    content: "";
    display: block;
    width: 5px;
    height: 3px;
    background-color: rgba(255,255,255,.8);
    position: absolute;
    bottom: 12px;
    right: 0;
}
.seek-bar-box.vbar > ul > li.on-current:before{
    left: 0;
}</style>
<div class="seek-bar-box vbar" id="seek-vbar">
    <ul>
        <li>1</li>
        <li>2</li>
        <li>3</li>
        <li>4</li>
        <li>5</li>
        <li>6</li>
        <li>7</li>
        <li>8</li>
        <li>9</li>
        <li>10</li>
    </ul>
    <span class="slider-btn">
        <i></i>
        <i></i>
    </span>
</div>
    </div>
    <script type="text/javascript" charset="utf-8" defer>/**
 * Created by r9luox on 2016/7/4.
 */

;(function(){
    var root = this,
        isTouch = 'ontouchstart' in window,
        empty = function(){},
        defaults = {
            direction: 'horizontal',    //方向 vertical 垂直
            onStart: empty,
            onMove: empty,
            onEnd: empty,
            isMark: true    //滑动时是否以刻度为单位
        };
    $(function(){

        var SeekBar = function(id, direction, options){
            this.options = $.extend(defaults, options);
            this.direction = direction || this.options.direction || 'horizontal';
            this.box = $('#' + (id || this.options.id).replace(/^#/i, ''));
            this.sliderBtn = this.box.find('.slider-btn');
            this.marks = this.box.find('ul>li');
            this.width = this.box.width();
            this.height = this.box.height();
            this._sliderBtnWidth = this.sliderBtn.width();
            this._sliderBtnHeight = this.sliderBtn.height();
            this.isMove = false;
            this._init();
        };

        SeekBar.prototype = {
            _init: function(){
                if(this.direction !== 'horizontal' && this.direction !== 'vertical'){
                    throw new Error('options direction is horizontal or vertical');
                }
                this._addEvent();
            },
            _addEvent: function(){
                this._events = {
                    down: isTouch ? 'touchstart' : 'mousedown',
                    move: isTouch ? 'touchmove' : 'mousemove',
                    up: isTouch ? 'touchend' : 'mouseup'
                };
                this.box.on(this._events.down, $.proxy(this, '_onStart'));
            },
            _onStart: function(evt){
                evt.preventDefault();
                evt.stopPropagation();
                evt = this._getEvent(evt);
                this.isMove = true;
                this._moveSlider(evt);
                $(document).on(this._events.move, $.proxy(this, '_onMove'));
                $(document).on(this._events.up, $.proxy(this, '_onEnd'));
                this._setHandler(evt, this.options.onStart);
            },
            _onMove: function(evt){
                if(!this.isMove) return;
                evt = this._getEvent(evt);
                this._moveSlider(evt);
            },
            _onEnd: function(evt){
                evt = this._getEvent(evt);
                this.isMove = false;
                $(document).off(this._events.move, $.proxy(this, '_onMove'));
                $(document).off(this._events.up, $.proxy(this, '_onEnd'));
                this._setHandler(evt, this.options.onEnd);
            },
            _getEvent: function(evt){
                return isTouch ? evt.originalEvent.changedTouches[0] : evt;
            },
            getTop: function(clientY){
                //碰撞检测
                var boxTop = this.box.offset().top,
                    top = clientY - boxTop;
                if(clientY <= boxTop){
                    top = 0;
                }
                if(clientY >= boxTop + this.height - this._sliderBtnHeight * .5){
                    top = this.height - this._sliderBtnHeight * .5;
                }
                var step = this.marks.get(0).getBoundingClientRect().height,
                    mesc = top % step;
                if(this.options.isMark){
                    top = step * Math.round(top / step) - ( Math.abs(mesc) < step ? 0 : step);
                    if(top >= this.height){
                        mesc = this.height / step;
                        top = this.height - this._sliderBtnHeight * .5;
                    }else{
                        mesc = top / step;
                    }
                }else{
                    mesc = Math.round(top / step);
                }
                return {top: top, index: mesc};
            },
            getLeft: function(clientX){
                //碰撞检测
                var boxLeft = this.box.offset().left,
                    left = clientX - boxLeft;
                if(clientX <= boxLeft){
                    left = 0;
                }
                if(clientX >= boxLeft + this.width - this._sliderBtnWidth * .5){
                    left = this.width - this._sliderBtnWidth * .5;
                }
                var step = this.marks.get(0).getBoundingClientRect().width,
                    mesc = left % step;
                if(this.options.isMark){
                    left = step * Math.round(left / step) - ( Math.abs(mesc) < step ? 0 : step);
                    if(left >= this.width){
                        mesc = this.width / step;
                        left = this.width - this._sliderBtnWidth * .5;
                    }else{
                        mesc = left / step;
                    }
                }else{
                    mesc = Math.round(left / step);
                }
                return {left: left, index: mesc};
            },
            _setHandler: function(evt, fn){
                var offset = 0;
                if(this.direction === 'horizontal'){
                    offset = this.getLeft(evt.clientX).left;
                    fn.call(this, this._current, offset, evt.clientX);
                }else{
                    offset = this.getTop(evt.clientY).top;
                    fn.call(this, this._current, offset, evt.clientY);
                }
            },
            _moveSlider: function(evt){
                if(this.direction === 'horizontal'){
                    this._setSlider(evt.clientX);
                }else{
                    this._setSlider(evt.clientY);
                }
            },
            _setSlider: function(client){
                //去除包含样式
                this.marks.removeClass('on-include on-current');
                //碰撞检测
                var obj, index;
                if(this.direction === 'horizontal'){
                    obj = this.getLeft(client);
                    index = obj.index;
                    this.sliderBtn.css('left', obj.left - 1);
                }else{
                    obj = this.getTop(client);
                    index = obj.index;
                    this.sliderBtn.css('top', obj.top - 1);
                }
                //添加包含样式
                this.box.find('ul>li:lt('+ index +')').addClass('on-include');
                $(this.marks[index - 1]).addClass('on-current');
                this._current = this.marks[index - 1];
                this.options.onMove.call(this, this._current, client);
                return this;
            },
            setTop: function(top){
                top = this.box.offset().top + top;
                this._setSlider(top);
            },
            setLeft: function(left){
                left = this.box.offset().left + left;
                this._setSlider(left);
            },
            getIndex: function(){
                return this._current;
            }
        };

        var SeekHBar = function(id, options){
            return new SeekBar(id, 'horizontal', options);
        };

        var SeekVBar = function(id, options){
            return new SeekBar(id, 'vertical', options);
        };

        root.SeekBar = SeekBar;
        root.SeekHBar = SeekHBar;
        root.SeekVBar = SeekVBar;
    });
}).call(this);
</script>

    <script>
        $(function(){
            var seekHBar = new SeekHBar('seek-hbar', {
                isMark: true,
                onStart: function(){
                    //console.log('onStart: ', this);
                },
                onEnd: function(){
                    //console.log('onEnd: ', this);
                }
            });
            seekHBar.setLeft(230);

            var seekVBar = new SeekVBar('seek-vbar', {
                isMark: true,
                onStart: function(){
                    //console.log('onStart: ', this);
                },
                onEnd: function(){
                    //console.log('onEnd: ', this);
                }
            });
            seekVBar.setTop(120);
        });
    </script>

<!--build footer-->
    <!--server loading-->
    <div class="server-loading loading" id="request-tip" style="display: none;"></div>

    <!--载入js-->
    <script src="modules/main.js?_cmbx_=94d8986763"></script>
    

</body>
</html>